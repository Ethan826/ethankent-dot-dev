<!DOCTYPE html>
<html><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <title>Locker_analogy - Ethan Kent&#39;s dev blog</title>

    
    
    <meta name="description" content="An extremely long analogy Consider this the director&rsquo;s cut of a strange story that includes a variety of alternative endings. The scene is set in a school with many floors and hallways, all lined with lockers. On the first day of class, you are trying to find a locker in which to store your backpack.
You say good morning to the teacher, and ask where you should put your backpack. The teacher returns your greeting, and tells you something unusual: &ldquo;I don&rsquo;t assign lockers." />
    <meta name="author" content="" />
    

    <link href="https://unpkg.com/@master/normal.css" rel="stylesheet">
    <script src="https://unpkg.com/@master/style@1.5.0"></script>
    <script src="https://unpkg.com/@master/styles@1.13.0"></script>
    <script src="https://unpkg.com/master-styles-group"></script>
    <script src="https://unpkg.com/themes.js"></script>
    <script>window.themes = window.themes || new window.Themes()</script>

    <style>
        :root {
            --font-sans: "Inter var", ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
        }
    </style></head>
<body class="bg:fade-84@dark font:fade-16@dark font:sans">
    <nav class="w:full h:90 fixed bg:fade-84/.95@dark bg:white z:1000">
    <div class="
        h:full
        w:full
        max-w:1200
        mx:auto
        px:32
        d:flex
        align-items:center
    ">
        <div>
            <a href="/" class="mr-3 font:extralight">
              
              Ethan Kent&#39;s dev blog
              
            </a>
        </div>

        <div class="ml:auto">
            
            
            
        </div>
    </div>
</nav>
<div class="d:flex flex:column@<=sm pt:90 px:24 jc:center gap:44 word-break:break-word">
        <div class="max-w:700 w:full box:content-box">
<article class="box:border-box pt:32">
    <header class="mb:32">
        <div class="font:40 font:extrabold">Locker_analogy</div>
        <div class="mt:16 f:fade-60">
            <time>Jan 24, 2020</time>
            </div>
    </header><div class="
    _:where(a):hover{text-decoration-color:fade}
    _:where(a){text-decoration:2;underline;fade-10;_text-decoration-color:fade-70@dark}
    _:where(blockquote){bl:5;solid;fade-76/.1;_bl:5;solid;fade-34/.1@dark}
    _:where(code){font:90%;_v:middle}
    _:where(code:not(.highlight_*,pre_*)){p:2;6;_r:4}
    _:where(del){text-decoration:1;line-through;fade-68;_text-decoration-color:red-64@dark}
    _:where(figcaption){text:14;_p:10;20;0;_width:fit;_mx:auto;_font:fade-56;_font:fade-57@dark}
    _:where(h1){font:40;_font:extrabold}
    _:where(h1,h2,h3)+:where(h1,h2,h3){mt:.5em}
    _:where(h1,h2,h3,h4,h5,h6){mt:2em}
    _:where(h2){mb:1em;_font:32}
    _:where(h3){font:24}
    _:where(h4){font:20}
    _:where(h5){font:16}
    _:where(h6){font:14}
    _:where(li)::marker{font:fade-44;_font:fade-68@dark}
    _:where(li){pl:.375em}
    _:where(mark){text-decoration:1;underline;#fce016;_bg:transparent;_text-decoration-color:rgb(252;224;22/.5)@dark}
    _:where(p,li){font:fade-76;_font:16;_line-height:1.65;_font:fade-34@dark}
    _:where(p,pre,blockquote,figure,ul,ol,table){my:1.125em}
    >:first-child{mt:0!}
    _:where(pre){p:20;_r:8;_overflow:auto}
    _:where(pre,code:not(.highlight_*)){bg:fade-2;_bg:fade-92!@dark}
    _:where(strong,b,a,code:not(.highlight_*),mark,del){font:fade-92;_font:fade-12@dark}
    _:where(table){width:full;_border-spacing:0}
    _:where(td){v:baseline}
    _:where(td,th):first-child{pl:0}
    _:where(td,th):last-child{pr:0}
    _:where(td,th){bb:1;solid;fade-92/.06;_p:6;_b:fade-4/.04@dark}
    _:where(th){font:fade-78;_font:14;_text:left;_font:fade-12@dark}
    _:where(th,p_code,li_code,a,mark){font:semibold;_font:medium@dark}
    _:where(ul){list-style-type:disc}
    _:where(ul,ol,blockquote){pl:1.5em}
    _:where(video,img){max-width:full}
    _:where(a,mark){text-underline-offset:3}
    _:where(hr){h:2;_bg:fade-10;_bg:fade-70@dark;_my:3em}
"><h2 id="an-extremely-long-analogy">An extremely long analogy</h2>
<p>Consider this the director&rsquo;s cut of a strange story that includes a variety
of alternative endings. The scene is set in a school with many floors and
hallways, all lined with lockers. On the first day of class, you are trying
to find a locker in which to store your backpack.</p>
<p>You say good morning to the teacher, and ask where you should put your
backpack. The teacher returns your greeting, and tells you something unusual:
&ldquo;I don&rsquo;t assign lockers. For that, we use a device called the BackpackHasher.
You tell it a bit about your backpack—the brand, color, and it gives you a
locker assignment.&rdquo;</p>
<p>&ldquo;Shouldn&rsquo;t I just put my backpack in the first empty locker I find,&rdquo; you ask.</p>
<p>&ldquo;No, there are a lot of students in this class, so finding an empty locker can
take a long time. It&rsquo;s a lot quicker to use the BackpackHasher, because it
will tell you directly where to go.&rdquo;</p>
<p>&ldquo;What if I forget where I put my backpack, or what if somebody else has to
get it for me,&rdquo; you ask.</p>
<p>&ldquo;They can just describe your backpack to the BackpackHasher and it will tell
them the same locker number it told you. The locker assignments seem random,
but as long as a backpack is described the same way, the BackpackHasher comes
up with the same locker number.&rdquo;</p>
<p>You wait in line for the teacher&rsquo;s strange machine, then you describe your
backpack, and the BackpackHasher tells you, &ldquo;go to locker 39.&rdquo;</p>
<p>&ldquo;Weird,&rdquo; you think, &ldquo;didn&rsquo;t the BackpackHasher tell that other student to go to
locker 39 a few minutes ago? In fact, I think I heard a <em>few</em> students get locker
39.&rdquo;</p>
<h3 id="alternate-ending-1-hashtable-with-pointers-to-arrays">Alternate ending 1 (hashtable with pointers to arrays)</h3>
<p>You walk directly to locker 39—it seems too small for a backpack,
actually—and open it. The locker is indeed too small to hold your backpack,
but it contains a note: &ldquo;Go to the third floor hallway south of Mr. Jones&rsquo;s
room. Put your backpack in the first open locker in that hallway.&rdquo; You see
another student opening his locker, and it contains a similar note, but
his note refers to the sixth floor hallway north of Ms. Smith&rsquo;s classroom.</p>
<p>You&rsquo;re a pretty fast walker, and you get to the third floor pretty quickly.
As you scan the hallway, you can tell that lockers A–E already have backpacks
in them, but locker F is sitting open. You put your backpack there and head
to class.</p>
<p>The schoolday ends, and you realize you forgot where you put your backpack.
But you describe your backpack to the BackpackHasher, which tells you to go
to locker 39, which has the note telling you to go to the third floor hallway
south of Mr. Jones&rsquo;s room.</p>
<p>As you arrive, you see another student take her backpack out of locker C. A
worker in a uniform marked &ldquo;Facilities&rdquo; is watching, and quickly opens all
the lockers after C. He moves the backpack in locker H into locker G, the
backpack from locker G into locker F, and so on, until he closes up the gap
caused by the student removing her backpack. He leaves the first empty locker
door open and closes the rest. (You couldn&rsquo;t see the backpacks from where you
were standing when the Facilities worker moved them around.)</p>
<p>You realize you are going to have to find your backpack by starting at the
first locker and looking in each locker in turn: the backpacks aren&rsquo;t
arranged in lockers in any particular order. But this is still easier than
searching the huge number of lockers in the hallway outside homeroom.</p>
<p>&ldquo;Pardon me, what happens if I go looking for my backpack but it isn&rsquo;t here,&rdquo;
you ask.</p>
<p>&ldquo;Well, you get to an empty locker and don&rsquo;t find your backpack, that&rsquo;s how
you know,&rdquo; responds the Facilities person. &ldquo;This works pretty well, except
that sometimes all the lockers get filled up. Then we have to get all the
backpacks out of the lockers and carry them to a hallway with more lockers,
and then go back and update the instructions in the locker that sent you over
here.&rdquo;</p>
<h3 id="alternate-ending-2-hashtable-with-pointers-to-linked-lists">Alternate ending 2 (hashtable with pointers to linked lists)</h3>
<p>Just like in ending 1, you are directed to the third-floor hallway. But this
time, you are explicitly told to open Locker J rather than find the first
empty locker in the hallway. Locker J already has a backpack, but it has a
laminated note hanging from a ring: &ldquo;If I&rsquo;m full, go to the second floor,
Locker N, and put your backpack there.&rdquo; (The floor and locker number are
handwritten onto the laminated card. There are some additional instructions,
but they relate to retrieving your backpack rather than putting it away.
You&rsquo;ll check those out later.)</p>
<p>You walk to Locker N on the second floor, which directs you to Locker Z on
basement level 1. But Locker Z&rsquo;s instructions don&rsquo;t tell you where to go
next. You see a person in a &ldquo;Facilities&rdquo; uniform. &ldquo;Pardon me. This locker is
full, but the instructions don&rsquo;t tell me where to go next.&rdquo;</p>
<p>&ldquo;Go, to, umm, how about Locker V in the cafeteria? Yeah, that one.&rdquo; You can
see he is looking at a list on his clipboard marked &ldquo;Available Lockers.&rdquo; He
crosses out &ldquo;Locker V&rdquo; on his list, and updates the instruction card in
Locker Z so that it refers to Locker V throughout. Locker V is empty, and you
put away your backpack</p>
<p>At the end of the schoolday, you&rsquo;ve forgotten your locker&rsquo;s location, but you
describe your backpack to the BackpackHasher, which sends you to Locker 39,
which points you to Locker J, then Locker N, then Locker Z. Locker Z&rsquo;s
instructions tell you to go to Locker V.</p>
<p>As you&rsquo;re about to leave for Locker V, you notice the rest of the
instructions on the laminated card: &ldquo;Take me with you.&rdquo; You realize the ring
attached to the instruction card is on a cord, and the cord retracts
automatically (like a seatbelt). You pull it out a little bit and it zips
back.</p>
<p>So you take the Locker Z instruction card with you to Locker V. It&rsquo;s a long
cord! You open Locker Z and discover your backpack. Before you close the
locker, you read the rest of the instructions on the card you took with you:
&ldquo;Call a Facilities worker for help.&rdquo;</p>
<p>You see a Facilities worker and ask for help. She takes the instruction card
tethered to Locker Z. She erases all references to Locker V on the
instruction card. She looks at the instructions in your locker, Locker V, and
sees that they refer to Locker Q (which you&rsquo;ve never seen before).</p>
<p>On the instruction card you handed her—the one for Locker Z—she writes &ldquo;Q&rdquo;
everywhere &ldquo;V&rdquo; used to be. Now it has exactly the same instructions as the
card for your locker, Locker V. She lets go of the instructions on the
lanyard, and it weaves its way through the school, making a satisfying &ldquo;zip&rdquo;
sound as it goes. Finally, the Facilities worker erases the instruction card
inside your locker, Locker V, then adds &ldquo;Locker V&rdquo; back to the list of &ldquo;Empty
Lockers.&rdquo; In short, the chain of instructions now skip your locker, and it is
back in the pool of empty lockers.</p>
<p>&ldquo;What was that all about,&rdquo; you ask.</p>
<p>&ldquo;Well, whoever came after you this morning saw your bag hanging in this
locker, Locker V, and we found that student a new locker, just like we did for
you. That student got Locker Q, as it happens. But now your old locker,&rdquo; she
points to Locker V, &ldquo;isn&rsquo;t in use. So there&rsquo;s no need for the student who
came after you to bother stopping here. That&rsquo;s why we rigged up the
retractable cords. Now we can just rewrite the instructions about where to go
rather than actually moving any bags around. And we can make the chain of
instructions however long it needs to be because we aren&rsquo;t restricted to
lockers next to each other that fit in a hallway. But it does make you
students have to do a lot of walking around sometimes.&rdquo;</p>
<h3 id="alternate-ending-3-hashtable-with-linear-probing-and-tombstones">Alternate ending 3 (hashtable with linear probing and tombstones)</h3>
<p>As before, the BackpackHasher tells you to go to Locker 39 right next your
homeroom classroom. This time, it&rsquo;s large enough to hold a backpack—but
it&rsquo;s already full. There&rsquo;s a note: &ldquo;Put your backpack in the first empty
higher-numbered locker.&rdquo; (You ignore some instructions about retrieving your
backpack.) Locker 40 and 41 are full, but Locker 42 is empty.</p>
<p>At the end of the schoolday, you describe your backpack to the BackpackHasher
and are told to go to Locker 39. The retrieval instructions say, &ldquo;If this
isn&rsquo;t your backpack, check the next higher-numbered locker. If you reach an
empty locker, your backpack isn&rsquo;t here.&rdquo;</p>
<p>You find yourA</p>
</div></article>
<footer class="py:24">
    <div class="f:fade-30 f:14 mb:8"></div>
    <div class="f:fade-60 f:12">Theme <a class="f:bold" href="https://github.com/serkodev/holy" _target="_blank">Holy</a></div>
</footer></div>
    </div>
</body>

</html>